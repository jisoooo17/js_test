<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
</head>
<body style="min-height: 2000px;">

  <button id="btn-modal">모달창</button>
  <div class="black-bg">
    <div class="white-bg">
      <h4>로그인하세요</h4>
      

      <!-- form -->
      <form action="success.html">
        <div class="my-3">
          <input type="text" class="form-control" id="email">
        </div>
        <div class="my-3">
          <input type="password" class="form-control" id="pw">
        </div>
        <button type="submit" class="btn btn-primary">전송</button>
        <button type="button" class="btn btn-danger" id="close">닫기</button>
      </form> 
    </div>
  </div> 

  <!-- nav -->
  <nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
      <span class="navbar-brand">Navbar</span>
      <span class="badge bg-dark">Dark 🔄</span>
      <button class="navbar-toggler" type="button">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav> 

  <ul class="list-group">
    <li class="list-group-item">An item</li>
    <li class="list-group-item">A second item</li>
    <li class="list-group-item">A third item</li>
    <li class="list-group-item">A fourth item</li>
    <li class="list-group-item">And a fifth one</li>
  </ul> 

  <div class="main-bg"></div>

  <!-- 캐러셀(슬라이드) -->
  <div class="slide-w">
    <div class="slide-container">
      <div class="slide-box">
        <img src="./img/car1.png" alt="">
      </div>
      <div class="slide-box">
        <img src="./img/car2.png" alt="">
      </div>
      <div class="slide-box">
        <img src="./img/car3.png" alt="">
      </div>
    </div>
  </div>
  <div class="btn-w">
    <button class="slide1 slide">1</button>
    <button class="slide2 slide">2</button>
    <button class="slide3 slide">3</button>
  </div>
  <div class="btn-w">
    <button class="btn-prev">이전</button>
    <button class="btn-next">디음</button>
  </div>
  
  <!-- alert -->
  <div class="alert alert-danger">
    <span class="timer">5</span>초 이내 구매시 사은품 증정
  </div>


  <div class="scl-box" style="width: 100%; height: 100px; overflow-y: scroll">
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Ab voluptatibus labore perspiciatis. Beatae nam provident praesentium, ex laudantium quidem voluptas impedit harum rerum explicabo corrupti, et nesciunt eligendi tenetur, eos laboriosam nemo eum eaque ratione labore repellendus. Suscipit animi molestias commodi earum exercitationem reprehenderit nam veritatis explicabo soluta odio? Ducimus nulla sunt itaque beatae quis! Facere dolorem doloribus, voluptatem illum in repellat? Est dignissimos facere ullam, nostrum magni ut sit modi maiores vero? Tenetur aliquid, hic velit non labore doloribus ex adipisci molestias neque ad, enim voluptates mollitia? Aperiam qui expedita ipsum laudantium reprehenderit velit voluptatem exercitationem eos sunt vero?
  </div>


  <!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

  <!-- nav -->
  <script>
    document.getElementsByClassName("navbar-toggler")[0].addEventListener("click", function(){
      document.getElementsByClassName("list-group")[0].classList.toggle("show");
    });

    /* 모달 - visibility*/
    document.getElementById("btn-modal").addEventListener("click", function(){
      document.querySelector(".black-bg").classList.add("show");
    });

    document.getElementById("close").addEventListener("click", function(){
      document.querySelector(".black-bg").classList.remove("show");
    });
  
    /* 모달 - display로 처리*/ 
    /*document.getElementById("btn-modal").addEventListener("click", function(){
      document.querySelector(".black-bg").style.display = "block";  // display를 block으로 전환
      setTimeout(() => blackBg.classList.add("show"), 10);  // opacity 애니메이션을 적용하기 위해 약간의 딜레이
    });

    document.getElementById("close").addEventListener("click", function(){
      document.querySelector(".black-bg").classList.remove("show");
      setTimeout(() => blackBg.style.display = "none", 1000);  // transition이 끝난 후 display를 none으로 설정
    });*/



    /* 이벤트 버블링 방지 */
    // bg 클릭 시 모달 닫기 - 
    document.querySelector(".black-bg").addEventListener("click", function(e){
      if(e.target == document.querySelector(".black-bg")){
        document.querySelector(".black-bg").classList.remove("show");
      }
    });

    /*
      e.target; // 유저가 실제로 누른거
      e.currentTarget; // 이벤트 리스너 달린곳 (this)
      e.preventDefault(); // 이벤트 기본동작 막아줌
      e.stopPropagation(); // 이벤트 버블링 막아줌
    */
  </script>

  <!-- 인풋 공백검사 & 이메일 유효성 -->
  <script>
    // 전송 버튼 누르면 
    // 저기 input에 입력한 값이 공백이면 alert 띄움
    document.querySelector("form").addEventListener("submit", function(e){
      let userEmail = document.getElementById("email").value; 
      let userPw = document.getElementById("pw").value
      if(userEmail.trim() == ""){
        e.preventDefault();
        alert("값을 입력하세요.");
      }

      if( !/\S+@\S+\.\S+/.test(userEmail)){
        e.preventDefault();
        alert("이메일 형식이 맞지 않습니다.");
      }
      

      if(userPw.trim().length < 6){
        alert("6자 이상 입력하세요.");
        e.preventDefault();
      }

      console.log(userPw)
      if(!/[A-Z]/.test(userPw)){
        e.preventDefault();
        alert("대문자하나 포함");
      }
    });
    
    // 이메일 유효성
    // 모든문자 @ 모든문자 . 모든문자
    // console.log(/\S+@\S+\.\S+/.test("aaa@bbb.com"));

      

  </script>

  <!-- input 이벤트 -->
  <script>
    // input은 값이 바뀔때 마다 실행 
    // change는 인풋의 포커스를 잃을때 실행
    /*document.getElementById("email").addEventListener("input", function(){
      console.log(123);
    });*/
  </script>

  <!-- 다크모드 버튼  -->
  <script>
    // badge 홀수번 클릭 시 버튼 내부 텍스트 Light로 변경, 짝수번 클릭 시 Dark로 변경
    // 클릭 횟수 저장 변수 추가

    let num = 0;
    document.querySelector(".badge").addEventListener("click", function(){
      num += 1;
      if(num % 2 === 0) {
        document.querySelector(".badge").innerHTML = "Light 🔄"
      } else {
        document.querySelector(".badge").innerHTML = "Dark 🔄"
      }
      
    })
  </script>


  <!-- 타이머 -->
  <script>
    let count = 5;
    const timer = setInterval(()=>{
      count--;
      document.querySelector(".timer").innerHTML = count;

      if(count == 0){
        document.querySelector(".alert").style.display = "none";
        clearInterval(timer)
      }
    }, 1000);


    // 콜백테스트
    setTimeout(test, 1000);
    function test(){
      //console.log("hi")
    }
    /*
    setTimeout(test(), 3000)이 작동하지 않는 이유는 함수를 실행하고 그 결과값을 전달하려고 하기 때문입니다. test()는 함수를 호출하는 표현식이므로, 즉시 실행되어 결과값을 반환합니다. 그래서 setTimeout에 전달되는 것은 함수의 반환값(undefined일 가능성이 큼)이지, 함수 자체가 아닙니다.

    ** 올바른 방식
    setTimeout에 함수 자체를 전달해야 하기 때문에, test() 대신 test를 전달해야 합니다. 이렇게 하면 함수가 지연 후에 실행됩니다.
    */
    
  </script>


  <!-- 캐러셀 (슬라이드) -->
  <script>
    // 숫자버튼
    /*document.querySelector(".slide1").addEventListener("click", function(){
      document.querySelector(".slide-container").style.transform = "translateX(0)"
    });
    document.querySelector(".slide2").addEventListener("click", function(){
      document.querySelector(".slide-container").style.transform = "translateX(-100vw)"
    });
    document.querySelector(".slide3").addEventListener("click", function(){
      document.querySelector(".slide-container").style.transform = "translateX(-200vw)"
    });*/


    // 다음 버튼
    // 다음 버튼 누르면 지금 보이는 사진이1이면 2번사진 보여주세요
    // 지금 보이는 사진이 2이면 3번사진 보여주세요
    /*let slideNum = 1;
    document.querySelector(".btn-next").addEventListener("click", function(){
      if(slideNum == 1){
        slideNum++;
        document.querySelector(".slide-container").style.transform = "translateX(-100vw)";
      } else if( slideNum == 2){
        slideNum++;
        document.querySelector(".slide-container").style.transform = "translateX(-200vw)";
      }
      console.log(slideNum)
    });

    // 이전 버튼
    document.querySelector(".btn-prev").addEventListener("click", function(){
      if(slideNum == 3){
        slideNum--;
        document.querySelector(".slide-container").style.transform = "translateX(-100vw)"
      } else if (slideNum == 2){
        slideNum--;
        document.querySelector(".slide-container").style.transform = "translateX(0)"
      }
      console.log(slideNum)
    });*/

    let slideNum = 0;
    let totalNum = document.querySelectorAll(".slide-box").length - 1;
    // console.log(document.querySelectorAll(".slide-box").length)
    document.querySelector(".btn-next").addEventListener("click", function(){
      if(slideNum < totalNum){
        slideNum++;
        document.querySelector(".slide-container").style.transform = `translateX(-${slideNum * 100}vw)`;
      } 
    });

    document.querySelector(".btn-prev").addEventListener("click", function(){
      
      if(slideNum > 0){
        console.log(slideNum)
        slideNum--;
        document.querySelector(".slide-container").style.transform = `translateX(-${slideNum * 100}vw)`;
      }
    });


    // 숫자 버튼 클릭 시 슬라이드 이동
    document.querySelectorAll(".slide").forEach((slide, index)=>{
      slide.addEventListener("click", function(){
        console.log(index)
        document.querySelector(".slide-container").style.transform = `translateX(-${index * 100}vw)`;
      });
    });
  </script>

  <!-- 스크롤 이벤트 -->
  <script>
    // 스크롤 100 이상이면 nav 폰트 줄이기
    window.addEventListener("scroll", function(){
      if(parseInt(window.scrollY) >= 100){
        document.querySelector(".navbar-brand").style.fontSize = "20px"
      } else {
        document.querySelector(".navbar-brand").style.fontSize = "30px"
      }
    });


    // 스크롤 끝까지 내리면 이벤트 발생
    document.querySelector(".scl-box").addEventListener("scroll", function(){
      let sclTop = parseInt(document.querySelector(".scl-box").scrollTop);
      let boxHt = document.querySelector(".scl-box").clientHeight; // 박스 높이
      let sclHt = document.querySelector(".scl-box").scrollHeight; // 스크롤 높이

      // 스크롤바 내린양 + 노출된 div의 스크롤 높이 == div 실제높이
      if(sclTop + boxHt >= sclHt){
        alert("스크롤 끝!");
      }
    });
    
    // 현재 페이지 끝까지 스크롤 체크
    // documentElement === querySelector("html")
    let alertShown = false; // 알림이 이미 표시되었는지 체크
    let lastScrollY = window.scrollY; // 마지막 스크롤 위치를 저장하는 변수

    document.addEventListener("scroll", function() {
      let pageTop = parseInt(window.scrollY); // 현재 페이지 스크롤 양
      let curPageHt = document.documentElement.clientHeight; // 페이지 보이는 부분 높이
      let pageHt = document.documentElement.scrollHeight; // 현재 페이지 실제 높이

      // 페이지 끝에 도달했는지 확인
      if (pageTop + curPageHt >= pageHt - 10 && !alertShown && pageTop > lastScrollY) {
        alert("페이지 끝");
        alertShown = true; // 알림 표시 후 플래그를 true로 설정
      }

      // 업스크롤할 때 플래그 초기화
      if (pageTop < lastScrollY) {
        alertShown = false; // 업스크롤하면 플래그 초기화
      }

      // 현재 스크롤 위치를 마지막 스크롤 위치로 업데이트
      lastScrollY = pageTop; 
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>